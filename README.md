# covid19-lipoprotein-metabolomics

We developed a supervised learning pipeline in Python 3.11 (pandas 2.2.2, scikit‑learn 1.4.2, xgboost 2.0.3) to discriminate mild from severe COVID‑19 (requirement for non‑invasive ventilation) in 78 consecutive hospital admissions (45 mild, 33 severe). Fifty‑six admission‑time variables—demographics, comorbidities, PSI, SOFA, routine inflammatory markers, an extensive ^1H‑NMR lipoprotein panel, three glycoproteins, 17 metabolites and six biologically‑motivated ratios—were screened as candidate predictors. Missing values (< 4 %) were imputed with five‑nearest‑neighbours; categorical attributes were label‑encoded, and continuous attributes were z‑standardised within each training fold. To offset the mild:severe imbalance (1.36:1), the XGBoost parameter scale_pos_weight was set to 1.2.

Inside a stratified five‑fold cross‑validation loop, recursive feature elimination (RFE) wrapped around an XGBoost classifier selected the ten most informative variables, beyond which performance plateaued. Bayesian optimisation with a Tree‑Parzen estimator (50 iterations) tuned the following hyper‑parameters: n_estimators = 320, learning_rate = 0.03, max_depth = 4, min_child_weight = 1, subsample = colsample_bytree = 0.80, gamma = 0, lambda = 1. Ten repeats of stratified five‑fold CV yielded mean ± SD accuracy 0.75 ± 0.04 and AUROC 0.82 ± 0.05; a stratified 20 % hold‑out confirmed accuracy 0.77 and AUROC 0.84, with acceptable calibration (Hosmer–Lemeshow p = 0.41).

Model interpretability used XGBoost’s built‑in gain‑based feature importance (Figure 1), which ranked IDL‑cholesterol, Glyc‑F, large VLDL particle count, HDL‑triglycerides, HDL particle number, isoleucine, tyrosine, LDL‑triglycerides, SOFA and PSI as the dominant contributors to severe‑disease prediction. The mean cross‑validated ROC curve is shown in Figure 2.
